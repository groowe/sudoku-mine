def newtry():
    grid = [['0' for i in range(9)] for i in range(9)]
    grid[0] = [3,0,0,2,0,0,1,0,0]
    grid[1] = [0,0,5,7,1,3,0,0,0]
    grid[2] = [0,0,7,4,6,0,8,0,0]
    grid[3] = [8,0,0,3,0,0,0,1,2]
    grid[4] = [7,0,0,8,5,0,0,0,9]
    grid[5] = [9,2,0,0,4,6,0,0,0]
    grid[6] = [0,7,0,0,0,0,0,4,6]
    grid[7] = [0,1,0,0,0,0,2,5,8]
    grid[8] = [0,0,0,5,0,4,0,9,0]
    for i in grid:
#        print(i)
        for i in range(len(grid)):
            for s in range(len(grid[i])):
                if grid[i][s] == 0:
                    grid[i][s] = '0'
#    for i in grid:
#        print(i)
#    print("hardtry")
    return grid

def newtry2():
    grid = [['0' for i in range(9)] for i in range(9)]

    grid[0] = [0,0,0,0,5,0,4,0,0]
    grid[1] = [8,0,0,0,0,3,5,0,0]
    grid[2] = [0,0,0,0,0,2,8,9,0]
    grid[3] = [6,0,5,0,0,1,0,0,0]
    grid[4] = [0,1,0,4,0,9,0,3,0]
    grid[5] = [0,0,0,6,0,0,1,0,8]
    grid[6] = [0,8,6,1,0,0,0,0,0]
    grid[7] = [0,0,2,3,0,0,0,0,9]
    grid[8] = [0,0,4,0,9,0,0,0,0]
    for i in grid:
#        print(i)
        for i in range(len(grid)):
            for s in range(len(grid[i])):
                if grid[i][s] == 0:
                    grid[i][s] = '123456789'
    return grid

def newtry3():
    grid = [['0' for i in range(9)] for i in range(9)]

    grid[0] = [0,0,0,0,5,0,4,0,0]
    grid[1] = [8,0,0,0,0,3,5,0,0]
    grid[2] = [0,0,0,0,0,2,8,9,0]
    grid[3] = [6,0,5,0,0,1,0,0,0]
    grid[4] = [0,1,0,4,0,9,0,3,0]
    grid[5] = [0,0,0,6,0,0,1,0,8]
    grid[6] = [0,8,6,1,0,0,0,0,0]
    grid[7] = [0,0,2,3,0,0,0,0,9]
    grid[8] = [0,0,4,0,9,0,0,0,0]
    for i in grid:
#        print(i)
        for i in range(len(grid)):
            for s in range(len(grid[i])):
                if grid[i][s] == 0:
                    grid[i][s] = '123456789'
    return grid


def newtry4():
    grid = [['0' for i in range(9)] for i in range(9)]

    grid[0] = [0,0,0,0,5,0,4,0,0]
    grid[1] = [8,0,0,0,0,3,5,0,0]
    grid[2] = [0,0,0,0,0,2,8,9,0]
    grid[3] = [6,0,5,0,0,1,0,0,0]
    grid[4] = [0,1,0,4,0,9,0,3,0]
    grid[5] = [0,0,0,6,0,0,1,0,8]
    grid[6] = [0,8,6,1,0,0,0,0,0]
    grid[7] = [0,0,2,3,0,0,0,0,9]
    grid[8] = [0,0,4,0,9,0,0,0,0]
    for i in grid:
#        print(i)
        for i in range(len(grid)):
            for s in range(len(grid[i])):
                if grid[i][s] == 0:
                    grid[i][s] = '123456789'
    return grid

def newtry5():
    grid = [['0' for i in range(9)] for i in range(9)]

    grid[0] = [0,0,0,0,0,0,2,9,0]
    grid[1] = [2,1,0,4,0,3,0,0,0]
    grid[2] = [3,0,0,0,5,2,0,0,0]
    grid[3] = [0,0,5,0,0,0,0,6,0]
    grid[4] = [0,7,0,6,0,8,0,4,0]
    grid[5] = [0,8,0,0,0,0,7,0,0]
    grid[6] = [0,0,0,7,6,0,0,0,8]
    grid[7] = [0,0,0,8,0,1,0,3,4]
    grid[8] = [0,4,1,0,0,0,0,0,0]
    for i in grid:
#        print(i)
        for i in range(len(grid)):
            for s in range(len(grid[i])):
                if grid[i][s] == 0:
                    grid[i][s] = '123456789'
    return grid


def newtry6():
    grid = [['0' for i in range(9)] for i in range(9)]

    grid[0] = [0,4,0,0,0,8,0,0,0]
    grid[1] = [0,0,8,0,0,0,6,7,0]
    grid[2] = [0,9,0,0,2,0,0,0,0]
    grid[3] = [9,0,0,8,0,0,4,0,2]
    grid[4] = [0,2,0,7,0,4,0,3,0]
    grid[5] = [1,0,4,0,0,3,0,0,5]
    grid[6] = [0,0,0,0,6,0,0,5,0]
    grid[7] = [0,5,9,0,0,0,1,0,0]
    grid[8] = [0,0,0,3,0,0,0,2,0]
    for i in grid:
#        print(i)
        for i in range(len(grid)):
            for s in range(len(grid[i])):
                if grid[i][s] == 0:
                    grid[i][s] = '123456789'
    return grid

def basictry():
        grid = [['0' for i in range(9)] for i in range(9)]
        grid[0][0] = 5
        grid[0][1] = 3
        grid[0][4] = 7
        grid[1][0] = 6
        grid[1][3] = 1
        grid[1][4] = 9
        grid[1][5] = 5
        grid[2][1] = 9
        grid[2][2] = 8
        grid[2][7] = 6
        grid[3][0] = 8
        grid[3][4] = 6
        grid[3][8] = 3
        grid[4][0] = 4
        grid[4][3] = 8
        grid[4][5] = 3
        grid[4][8] = 1
        grid[5][0] = 7
        grid[5][4] = 2
        grid[5][8] = 6
        grid[6][1] = 6
        grid[6][6] = 2
        grid[6][7] = 8
        grid[7][3] = 4
        grid[7][4] = 1
        grid[7][5] = 9
        grid[7][8] = 5
        grid[8][4] = 8
        grid[8][7] = 7
        grid[8][8] = 9
        return grid

def standardize(grid):

#    print(grid)
    digits = [i for i in range(1,10)]
    for x in range(len(grid)):
        for y in range(len(grid[x])):
            if grid[x][y] not in digits:
                grid[x][y] = None
#    print("stand")
#    print(grid)
    return grid

def preprint(line):
    s = str(line)
    s = s.replace("None"," ").replace("[","|")
    s = s.replace("]","|")
    line = s
    newline = ""
    countchar = 0
    checkchar = ","
    for char in line:
        if char == checkchar:
            countchar +=1
            if countchar % 3 == 0:
                newline +='|'
            else:
                newline +=' '
        else:
            newline+=char
    return newline


def printgrid():
    print("_"*27)
    for x in range(len(grid)):
#        print('x')
#        print(x)
        if x > 0 and x % 3 == 0:
            print("_"*27)
        s = preprint(grid[x])
#        print(len(s))
        print("{}".format(s))
    print("_"*27)

def done():
    for x in grid:
        for y in x:
            if type(y) != int:
                return False
    return True

def in_neighbours(num,x,y):
    modx = int(x/3)
    mody = int(y/3)
    for a in range(9):
        moda = int(a/3)
        for b in range(9):
            modb = int(b/3)
            sqr = ((modx == moda) and (mody == modb))
            row = (a == x)
            cul = (y == b)
            diff = (x!=a and y != b)
            st  = (type(grid[a][b]) == int)
            tr = ((sqr or row or cul) and diff and st)
            if tr == True:
                if grid[a][b] == num:
                    return False
    return True




def solve():
    global backgrid
    global grid
    for num in range(1,10):
        for x in range(9):
            for y in range(9):
                if type(grid[x][y]) != int:
                    av = in_neighbours(num,x,y)
                    if av == True:
                        if str(num) not in backgrid[x][y]:
                            backgrid[x][y] += str(num)
    for x in range(9):
        for y in range(9):
            if type(backgrid[x][y]) == str:
                if len(backgrid[x][y]) == 1:
                    ins = int(backgrid[x][y])
                    backgrid[x][y] = ins
                    grid[x][y] = ins
    for x in range(9):
        print(backgrid[x])
    input()



def initialize():
    global backgrid
    for x in range(9):
        for y in range(9):
            if type(grid[x][y]) == int:
                backgrid[x][y] = grid[x][y]
            else:
                backgrid[x][y] = ""

def main():
    printgrid()
    initialize()
    while not done():
        solve()
        printgrid()
        print("_"*27)


if __name__ == "__main__":
    backgrid = [[None for i in range(9)] for i in range(9)]
    grid = newtry()
#    grid = basictry()
#    grid = newtry2()
#    grid = newtry3()
#    grid = newtry4()
#    grid = newtry5()
#    grid = newtry6()
    grid = standardize(grid)

    main()
